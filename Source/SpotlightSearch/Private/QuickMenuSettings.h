// Copyright Out-of-the-Box Plugins 2018-2023. All Rights Reserved.

#pragma once

#include <Engine/DeveloperSettings.h>

#include "QuickMenuSettings.generated.h"

/**
 * @brief Editor Settings for Quick Menu behavior customization
 */
UCLASS(config = Editor, defaultconfig)
class QUICKMENU_API UQuickMenuSettings : public UDeveloperSettings
{
	GENERATED_BODY()

public:
	/**
	 * @brief Display all the possible commands instead of recent commands when no input is given 
	 */
	UPROPERTY(EditAnywhere, Category = Customization, config)
	bool bShowAllOptionsWhenEmpty = false;
	/**
	 * @brief Includes How-do-I tutorials from Mathew Wadstein inside the entries
	 */
	UPROPERTY(EditAnywhere, Category = Customization, config)
	bool bIncludeTutorials = true;
	/**
	 * @brief Includes shortcuts to open specific settings sections inside the entries
	 */
	UPROPERTY(EditAnywhere, Category = Customization, config)
	bool bIncludeSettingSections = true;
	/**
	 * @brief Includes shortcuts to open specific assets inside the entries
	 */
	UPROPERTY(EditAnywhere, Category = Customization, config)
	bool bIncludeAssets = true;
	/**
	 * @brief Matching percentage required for an entry to show up as a fuzzy search.
	 */
	UPROPERTY(EditAnywhere, Category = Customization, config, meta = (UIMin = "0.0", UIMax = "100.0"))
	float FuzzySearchMatchPercentage = 75.0f;
	/**
	 * @brief Matching percentage required for an entry to show up as a fuzzy search.
	 */
	UPROPERTY(EditAnywhere, Category = Customization, config)
	FVector2D WindowSize = FVector2D(680.f, 430.f);
	/**
	 * @brief Registers a command on top of the Recent Commands list and saves the config.
	 * @param CommandName Unique name used to identify the command that was executed
	 */
	void RegisterRecentCommand(const FString& CommandName);
	/**
	 * @brief Returns the current list of Recently ran commands
	 * @note Persistent across sessions
	 * @return Ordered list of the most recent ran commands
	 */
	const TArray<FString>& GetRecentCommands() const;
	/**
	 * @brief Callback executed when the WindowSize property is changed
	 */
	TMulticastDelegate<void(FVector2D NewSize)> OnWindowSizeChanged;
protected:
	/**
	 * @brief Recently executed commands
	 * @note Saved in the config to ensure they are kept across sessions
	 */
	UPROPERTY(EditAnywhere, Category = Customization, config)
	TArray<FString> RecentCommands;
	/**
	 * @brief Maximum number of entries we will display under recent commands
	 */
	UPROPERTY(EditAnywhere, Category = Customization, config)
	int32 MaxRecentCommands = 5;

private:
	// Begin UDeveloperSettings interface
	virtual void PostEditChangeProperty(struct FPropertyChangedEvent& PropertyChangedEvent) override;
	virtual FName GetContainerName() const override;
	virtual FName GetCategoryName() const override;
	virtual FName GetSectionName() const override;
#if WITH_EDITOR
	virtual FText GetSectionText() const override;
#endif
	// End UDeveloperSettings interface
};